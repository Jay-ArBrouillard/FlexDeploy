<?xml version=\"1.0\" encoding=\"Unicode\"?>\n<ns0:WorkFlow xmlns:ns1=\"http://flexagon.com/flexdeploy/workflow/common\" xmlns:ns0=\"http://flexagon.com/flexdeploy/workflow\">\n   <ns1:Name>OIC Package Deploy Solutions</ns1:Name>\n   <ns1:Description>Package deploy is separate for SG and MG as both needs to maintain separate properties</ns1:Description>\n   <ns0:Inputs>\n      <ns0:Variable>\n         <ns1:Name>AD_OIC_UPD_CONNECTIONS</ns1:Name>\n         <ns1:Type>String</ns1:Type>\n         <ns0:returnAsOutput>false</ns0:returnAsOutput>\n         <ns1:isConstant>false</ns1:isConstant>\n         <ns1:InitialValue>NONE</ns1:InitialValue>\n         <ns1:DisplayName>Update Connection Mode</ns1:DisplayName>\n         <ns1:Required>true</ns1:Required>\n         <ns1:ListData>ALL,NONE,SPECIFIC</ns1:ListData>\n         <ns1:Multiselect>false</ns1:Multiselect>\n      </ns0:Variable>\n      <ns0:Variable>\n         <ns1:Name>AD_OIC_CONNECITON_LIST</ns1:Name>\n         <ns1:Type>String</ns1:Type>\n         <ns0:returnAsOutput>false</ns0:returnAsOutput>\n         <ns1:isConstant>false</ns1:isConstant>\n         <ns1:DisplayName>Connection list</ns1:DisplayName>\n      </ns0:Variable>\n   </ns0:Inputs>\n   <ns0:Steps>\n      <ns0:Step>\n         <ns1:Name>Missing Connection Ids for SPECIFIC mode</ns1:Name>\n         <ns1:StepId>1</ns1:StepId>\n         <ns0:If>\n            <ns0:Condition>\n               <ns0:Expression>AD_OIC_UPD_CONNECTIONS.equals(&quot;SPECIFIC&quot;) &amp;&amp; (AD_OIC_CONNECITON_LIST == null || AD_OIC_CONNECITON_LIST.trim().equals(&quot;&quot;))</ns0:Expression>\n            </ns0:Condition>\n            <ns0:Steps>\n               <ns0:Step>\n                  <ns1:Name>RaiseFault</ns1:Name>\n                  <ns1:StepId>1.1</ns1:StepId>\n                  <ns0:RaiseFault>\n                     <ns0:FaultName>SPECIFIC</ns0:FaultName>\n                     <ns0:FaultDetail>When mode is SPECIFIC, connection ids are required</ns0:FaultDetail>\n                  </ns0:RaiseFault>\n               </ns0:Step>\n            </ns0:Steps>\n         </ns0:If>\n      </ns0:Step>\n      <ns0:Step>\n         <ns1:Name>Copy connectionPlan</ns1:Name>\n         <ns1:StepId>2</ns1:StepId>\n         <ns0:InvokePlugin>\n            <ns0:PluginName>FlexagonFilePlugin</ns0:PluginName>\n            <ns0:PluginOperation>copy</ns0:PluginOperation>\n            <ns0:EndpointInstanceOverrideExpression>false</ns0:EndpointInstanceOverrideExpression>\n            <ns0:InvokePluginTypeVersion>v2</ns0:InvokePluginTypeVersion>\n            <ns0:consumesArtifacts>true</ns0:consumesArtifacts>\n            <ns0:producesArtifacts>false</ns0:producesArtifacts>\n            <ns0:EndpointSelection>\n               <ns0:EndpointSelectionChoice>All</ns0:EndpointSelectionChoice>\n            </ns0:EndpointSelection>\n            <ns0:EndpointExecutionChoice>Any</ns0:EndpointExecutionChoice>\n            <ns0:PluginInputs>\n               <ns0:PluginInput>\n                  <ns0:Name>FDFILE_INP_FILE_FILTER</ns0:Name>\n                  <ns0:ValueType>Text</ns0:ValueType>\n                  <ns0:Encrypted>false</ns0:Encrypted>\n                  <ns1:Type>String</ns1:Type>\n                  <ns0:Text>*.properties</ns0:Text>\n               </ns0:PluginInput>\n               <ns0:PluginInput>\n                  <ns0:Name>FDFILE_INP_FILE_FILTER_EXCLUDED</ns0:Name>\n                  <ns0:ValueType>Text</ns0:ValueType>\n                  <ns0:Encrypted>false</ns0:Encrypted>\n                  <ns1:Type>String</ns1:Type>\n               </ns0:PluginInput>\n               <ns0:PluginInput>\n                  <ns0:Name>FDFILE_INP_SOURCE_PATH</ns0:Name>\n                  <ns0:ValueType>Expression</ns0:ValueType>\n                  <ns0:Encrypted>false</ns0:Encrypted>\n                  <ns1:Type>String</ns1:Type>\n                  <ns0:Value>\n                     <ns0:Expression>FD_ARTIFACTS_DIR</ns0:Expression>\n                  </ns0:Value>\n               </ns0:PluginInput>\n               <ns0:PluginInput>\n                  <ns0:Name>FDFILE_INP_TARGET_PATH</ns0:Name>\n                  <ns0:ValueType>Expression</ns0:ValueType>\n                  <ns0:Encrypted>false</ns0:Encrypted>\n                  <ns1:Type>String</ns1:Type>\n                  <ns0:Value>\n                     <ns0:Expression>FD_TEMP_DIR</ns0:Expression>\n                  </ns0:Value>\n               </ns0:PluginInput>\n               <ns0:PluginInput>\n                  <ns0:Name>FDFILE_INP_CLEAN_DIRECTORY</ns0:Name>\n                  <ns0:ValueType>Text</ns0:ValueType>\n                  <ns0:Encrypted>false</ns0:Encrypted>\n                  <ns1:Type>Boolean</ns1:Type>\n                  <ns0:Text>false</ns0:Text>\n               </ns0:PluginInput>\n            </ns0:PluginInputs>\n            <ns0:UserInputs/>\n            <ns0:PluginOutputs/>\n            <ns0:UserOutputs/>\n         </ns0:InvokePlugin>\n      </ns0:Step>\n      <ns0:Step>\n         <ns1:Name>Clone Attachments</ns1:Name>\n         <ns1:StepId>3</ns1:StepId>\n         <ns0:InvokePlugin>\n            <ns0:PluginName>FlexagonGITPlugin</ns0:PluginName>\n            <ns0:PluginOperation>clone</ns0:PluginOperation>\n            <ns0:EndpointInstanceOverrideExpression>false</ns0:EndpointInstanceOverrideExpression>\n            <ns0:InvokePluginTypeVersion>v2</ns0:InvokePluginTypeVersion>\n            <ns0:consumesArtifacts>false</ns0:consumesArtifacts>\n            <ns0:producesArtifacts>false</ns0:producesArtifacts>\n            <ns0:EndpointSelection>\n               <ns0:EndpointSelectionChoice>All</ns0:EndpointSelectionChoice>\n            </ns0:EndpointSelection>\n            <ns0:EndpointExecutionChoice>Any</ns0:EndpointExecutionChoice>\n            <ns0:PluginInputs>\n               <ns0:PluginInput>\n                  <ns0:Name>FDGIT_INP_INSTANCE_CODE</ns0:Name>\n                  <ns0:ValueType>Expression</ns0:ValueType>\n                  <ns0:Encrypted>false</ns0:Encrypted>\n                  <ns1:Type>String</ns1:Type>\n                  <ns0:Value>\n                     <ns0:Expression>FDBLD_GIT_SOURCE1_INSTANCE</ns0:Expression>\n                  </ns0:Value>\n               </ns0:PluginInput>\n               <ns0:PluginInput>\n                  <ns0:Name>FDGIT_INP_DEST_SUBFOLDER</ns0:Name>\n                  <ns0:ValueType>Text</ns0:ValueType>\n                  <ns0:Encrypted>false</ns0:Encrypted>\n                  <ns1:Type>String</ns1:Type>\n               </ns0:PluginInput>\n               <ns0:PluginInput>\n                  <ns0:Name>FDGIT_INP_BRANCH</ns0:Name>\n                  <ns0:ValueType>Expression</ns0:ValueType>\n                  <ns0:Encrypted>false</ns0:Encrypted>\n                  <ns1:Type>String</ns1:Type>\n                  <ns0:Value>\n                     <ns0:Expression>FDBLD_STREAM_NAME</ns0:Expression>\n                  </ns0:Value>\n               </ns0:PluginInput>\n               <ns0:PluginInput>\n                  <ns0:Name>FDGIT_INP_DEPTH</ns0:Name>\n                  <ns0:ValueType>Text</ns0:ValueType>\n                  <ns0:Encrypted>false</ns0:Encrypted>\n                  <ns1:Type>Integer</ns1:Type>\n                  <ns0:Text></ns0:Text>\n               </ns0:PluginInput>\n               <ns0:PluginInput>\n                  <ns0:Name>FDGIT_INP_SPARSE_CHECKOUT_FOLDERS</ns0:Name>\n                  <ns0:ValueType>Expression</ns0:ValueType>\n                  <ns0:Encrypted>false</ns0:Encrypted>\n                  <ns1:Type>String</ns1:Type>\n                  <ns0:Value>\n                     <ns0:Expression>&quot;/OIC/ConnectionAttachmentsOverride/&quot; + FD_ENVIRONMENT_CODE + &quot;/attachments,OIC/ConnectionAttachmentsOverride/GLOBAL/attachments&quot;</ns0:Expression>\n                  </ns0:Value>\n               </ns0:PluginInput>\n            </ns0:PluginInputs>\n            <ns0:UserInputs/>\n            <ns0:PluginOutputs/>\n            <ns0:UserOutputs/>\n         </ns0:InvokePlugin>\n      </ns0:Step>\n      <ns0:Step>\n         <ns1:Name>Attachments</ns1:Name>\n         <ns1:StepId>4</ns1:StepId>\n         <ns0:InvokePlugin>\n            <ns0:PluginName>FlexagonShellPlugin</ns0:PluginName>\n            <ns0:PluginOperation>execute</ns0:PluginOperation>\n            <ns0:EndpointInstanceOverrideExpression>false</ns0:EndpointInstanceOverrideExpression>\n            <ns0:InvokePluginTypeVersion>v2</ns0:InvokePluginTypeVersion>\n            <ns0:consumesArtifacts>false</ns0:consumesArtifacts>\n            <ns0:producesArtifacts>false</ns0:producesArtifacts>\n            <ns0:EndpointSelection>\n               <ns0:EndpointSelectionChoice>All</ns0:EndpointSelectionChoice>\n            </ns0:EndpointSelection>\n            <ns0:EndpointExecutionChoice>Any</ns0:EndpointExecutionChoice>\n            <ns0:PluginInputs>\n               <ns0:PluginInput>\n                  <ns0:Name>FDSHELL_INP_CODE_SNIPPET</ns0:Name>\n                  <ns0:ValueType>Text</ns0:ValueType>\n                  <ns0:Encrypted>false</ns0:Encrypted>\n                  <ns1:Type>String</ns1:Type>\n                  <ns0:Text>GBL_SRC_DIR=$FD_TEMP_DIR/OIC/ConnectionAttachmentsOverride/GLOBAL\nENV_SRC_DIR=$FD_TEMP_DIR/OIC/ConnectionAttachmentsOverride/$FD_ENVIRONMENT_CODE\nDST_DIR=$FD_TEMP_DIR/OIC_Attachments\n\nmkdir -p $DST_DIR\nif [ -d $GBL_SRC_DIR ]\nthen\n        cp -r $GBL_SRC_DIR/* $DST_DIR\nfi\n\nif [ -d $ENV_SRC_DIR ]\nthen\n        cp -r $ENV_SRC_DIR/* $DST_DIR\nfi\n\ncd $DST_DIR\nMULTIPLE_FILES_FOR_CONNECTION_ID=$(find . -type f | cut -f1-3 -d&quot;/&quot; | sort | uniq -c | grep -v &quot; 1 &quot; | wc -l)\nif [ $MULTIPLE_FILES_FOR_CONNECTION_ID -gt 0 ]\nthen\n        echo &quot;Multiple files found for single connection/property in $DST_DIR&quot;\n        exit 99\nfi</ns0:Text>\n               </ns0:PluginInput>\n               <ns0:PluginInput>\n                  <ns0:Name>FDSHELL_INP_STOP_ON_ERROR</ns0:Name>\n                  <ns0:ValueType>Text</ns0:ValueType>\n                  <ns0:Encrypted>false</ns0:Encrypted>\n                  <ns1:Type>Boolean</ns1:Type>\n                  <ns0:Text>false</ns0:Text>\n               </ns0:PluginInput>\n               <ns0:PluginInput>\n                  <ns0:Name>FDSHELL_INP_DISABLE_ECHO</ns0:Name>\n                  <ns0:ValueType>Text</ns0:ValueType>\n                  <ns0:Encrypted>false</ns0:Encrypted>\n                  <ns1:Type>Boolean</ns1:Type>\n                  <ns0:Text>false</ns0:Text>\n               </ns0:PluginInput>\n               <ns0:PluginInput>\n                  <ns0:Name>FDSHELL_INP_RESTRICT_ENVIRONMENT</ns0:Name>\n                  <ns0:ValueType>Text</ns0:ValueType>\n                  <ns0:Encrypted>false</ns0:Encrypted>\n                  <ns1:Type>String</ns1:Type>\n               </ns0:PluginInput>\n               <ns0:PluginInput>\n                  <ns0:Name>FDSHELL_INP_NO_SECURE_VARIABLES</ns0:Name>\n                  <ns0:ValueType>Text</ns0:ValueType>\n                  <ns0:Encrypted>false</ns0:Encrypted>\n                  <ns1:Type>Boolean</ns1:Type>\n                  <ns0:Text>false</ns0:Text>\n               </ns0:PluginInput>\n               <ns0:PluginInput>\n                  <ns0:Name>FDSHELL_INP_LOCK</ns0:Name>\n                  <ns0:ValueType>Text</ns0:ValueType>\n                  <ns0:Encrypted>false</ns0:Encrypted>\n                  <ns1:Type>String</ns1:Type>\n               </ns0:PluginInput>\n            </ns0:PluginInputs>\n            <ns0:UserInputs/>\n            <ns0:PluginOutputs/>\n            <ns0:UserOutputs/>\n         </ns0:InvokePlugin>\n      </ns0:Step>\n      <ns0:Step>\n         <ns1:Name>packageDeploy</ns1:Name>\n         <ns1:StepId>5</ns1:StepId>\n         <ns0:InvokePlugin>\n            <ns0:PluginName>FlexagonOICPlugin</ns0:PluginName>\n            <ns0:PluginOperation>packageDeploy</ns0:PluginOperation>\n            <ns0:EndpointInstanceOverrideExpression>false</ns0:EndpointInstanceOverrideExpression>\n            <ns0:InvokePluginTypeVersion>v2</ns0:InvokePluginTypeVersion>\n            <ns0:consumesArtifacts>true</ns0:consumesArtifacts>\n            <ns0:producesArtifacts>false</ns0:producesArtifacts>\n            <ns0:EndpointSelection>\n               <ns0:EndpointSelectionChoice>All</ns0:EndpointSelectionChoice>\n            </ns0:EndpointSelection>\n            <ns0:EndpointExecutionChoice>Any</ns0:EndpointExecutionChoice>\n            <ns0:PluginInputs>\n               <ns0:PluginInput>\n                  <ns0:Name>FDOIC_INP_CLOUD_ACCOUNT_CODE</ns0:Name>\n                  <ns0:ValueType>Text</ns0:ValueType>\n                  <ns0:Encrypted>false</ns0:Encrypted>\n                  <ns1:Type>String</ns1:Type>\n               </ns0:PluginInput>\n               <ns0:PluginInput>\n                  <ns0:Name>FDOIC_INP_REPLACE_INTEGRATION</ns0:Name>\n                  <ns0:ValueType>Expression</ns0:ValueType>\n                  <ns0:Encrypted>false</ns0:Encrypted>\n                  <ns1:Type>Boolean</ns1:Type>\n                  <ns0:Value>\n                     <ns0:Expression>true</ns0:Expression>\n                  </ns0:Value>\n               </ns0:PluginInput>\n               <ns0:PluginInput>\n                  <ns0:Name>FDOIC_INP_CONNECTION_PLAN</ns0:Name>\n                  <ns0:ValueType>Text</ns0:ValueType>\n                  <ns0:Encrypted>false</ns0:Encrypted>\n                  <ns1:Type>String</ns1:Type>\n               </ns0:PluginInput>\n               <ns0:PluginInput>\n                  <ns0:Name>FDOIC_INP_PARTIAL_DEPLOY_DELAY</ns0:Name>\n                  <ns0:ValueType>Text</ns0:ValueType>\n                  <ns0:Encrypted>false</ns0:Encrypted>\n                  <ns1:Type>Integer</ns1:Type>\n                  <ns0:Text>0</ns0:Text>\n               </ns0:PluginInput>\n               <ns0:PluginInput>\n                  <ns0:Name>FDOIC_INP_UPDATE_CONNECTION_MODE</ns0:Name>\n                  <ns0:ValueType>Expression</ns0:ValueType>\n                  <ns0:Encrypted>false</ns0:Encrypted>\n                  <ns1:Type>String</ns1:Type>\n                  <ns0:Value>\n                     <ns0:Expression>AD_OIC_UPD_CONNECTIONS</ns0:Expression>\n                  </ns0:Value>\n               </ns0:PluginInput>\n               <ns0:PluginInput>\n                  <ns0:Name>FDOIC_INP_UPDATE_CONNECTION_LIST</ns0:Name>\n                  <ns0:ValueType>Expression</ns0:ValueType>\n                  <ns0:Encrypted>false</ns0:Encrypted>\n                  <ns1:Type>String</ns1:Type>\n                  <ns0:Value>\n                     <ns0:Expression>AD_OIC_CONNECITON_LIST</ns0:Expression>\n                  </ns0:Value>\n               </ns0:PluginInput>\n               <ns0:PluginInput>\n                  <ns0:Name>FDOIC_INP_ATTACHMENT_OVERRIDE_DIRECTORY</ns0:Name>\n                  <ns0:ValueType>Expression</ns0:ValueType>\n                  <ns0:Encrypted>false</ns0:Encrypted>\n                  <ns1:Type>String</ns1:Type>\n                  <ns0:Value>\n                     <ns0:Expression>&quot;${FD_TEMP_DIR}/OIC_Attachments&quot;</ns0:Expression>\n                  </ns0:Value>\n               </ns0:PluginInput>\n               <ns0:PluginInput>\n                  <ns0:Name>FDOIC_INP_START_SCHEDULES</ns0:Name>\n                  <ns0:ValueType>Text</ns0:ValueType>\n                  <ns0:Encrypted>false</ns0:Encrypted>\n                  <ns1:Type>Boolean</ns1:Type>\n                  <ns0:Text>true</ns0:Text>\n               </ns0:PluginInput>\n               <ns0:PluginInput>\n                  <ns0:Name>FDOIC_INP_ENABLE_TRACING</ns0:Name>\n                  <ns0:ValueType>Text</ns0:ValueType>\n                  <ns0:Encrypted>false</ns0:Encrypted>\n                  <ns1:Type>Boolean</ns1:Type>\n                  <ns0:Text>true</ns0:Text>\n               </ns0:PluginInput>\n               <ns0:PluginInput>\n                  <ns0:Name>FDOIC_INP_ENABLE_PAYLOAD_TRACING</ns0:Name>\n                  <ns0:ValueType>Text</ns0:ValueType>\n                  <ns0:Encrypted>false</ns0:Encrypted>\n                  <ns1:Type>Boolean</ns1:Type>\n                  <ns0:Text>true</ns0:Text>\n               </ns0:PluginInput>\n            </ns0:PluginInputs>\n            <ns0:UserInputs/>\n            <ns0:PluginOutputs/>\n            <ns0:UserOutputs/>\n         </ns0:InvokePlugin>\n      </ns0:Step>\n   </ns0:Steps>\n</ns0:WorkFlow>\r
